{"version":3,"sources":["app/app.coffee","app/scripts/controllers.coffee","app/scripts/directives.coffee","app/scripts/filters.coffee","app/scripts/services.coffee"],"names":[],"mappings":"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","file":"..\\public\\js\\app.js","sourcesContent":["'use strict'\r\n\r\n# Declare app level module which depends on filters, and services\r\nApp = angular.module('app', [\r\n  'ngCookies'\r\n  'ngResource'\r\n  'app.controllers'\r\n  'app.directives'\r\n  'app.filters'\r\n  'app.services'\r\n  'partials'\r\n])\r\n\r\nApp.config([\r\n  '$routeProvider'\r\n  '$locationProvider'\r\n\r\n($routeProvider, $locationProvider, config) ->\r\n\r\n  $routeProvider\r\n    .when('/', {templateUrl: '/partials/katalog.html'})\r\n\r\n    # Catch all\r\n    .otherwise({redirectTo: '/'})\r\n\r\n  # Without server side support html5 must be disabled.\r\n  $locationProvider.html5Mode(false)\r\n])\r\n","'use strict'\r\n\r\n### Controllers ###\r\n\r\nangular.module('app.controllers', ['ui.sortable'])\r\n\r\n.controller('AppCtrl', [\r\n  '$scope'\r\n  '$location'\r\n  '$resource'\r\n  '$rootScope'\r\n\r\n($scope, $location, $resource, $rootScope) ->\r\n\r\n  # Uses the url to determine if the selected\r\n  # menu item should have the class active.\r\n  $scope.$location = $location\r\n  $scope.$watch('$location.path()', (path) ->\r\n    $scope.activeNavId = path || '/'\r\n  )\r\n\r\n  # getClass compares the current url with the id.\r\n  # If the current url starts with the id it returns 'active'\r\n  # otherwise it will return '' an empty string. E.g.\r\n  #\r\n  #   # current url = '/products/1'\r\n  #   getClass('/products') # returns 'active'\r\n  #   getClass('/orders') # returns ''\r\n  #\r\n  $scope.getClass = (id) ->\r\n    if $scope.activeNavId.substring(0, id.length) == id\r\n      return 'active'\r\n    else\r\n      return ''\r\n])\r\n\r\n\r\n.controller('PagesCtrl', ($scope, $q, pagesSrv, $filter) ->\r\n\r\n  $scope.pages    = []\r\n  $scope.tileSize = 'm-smallTiles'\r\n\r\n  $scope.cutting      = false\r\n  $scope.cutPageIndex = null\r\n  $scope.isPreview    = false\r\n  $scope.isLoading    = false\r\n\r\n  $scope.cutPage = (index) ->\r\n    $scope.cutting      = true\r\n    $scope.cutPageIndex = index\r\n\r\n  $scope.pastePage = (index) ->\r\n    cutPage = $scope.pages[$scope.cutPageIndex]         # GET PAGE WE WANT TO MOVE\r\n    $scope.pages.splice index, 0, cutPage               # PASTE THE PAGE\r\n\r\n    # CUT OUT the PAGE from an OLD PLACE\r\n    # IF THE PAGE WAS TAKEN FROM SUBSEQUENT PLACE THEN THE ONE THAT WAS CHOSEN\r\n    # TO PLACE THE PAGE THAN WE NED TO ADJUST ITS INDEX\r\n    $scope.cutPageIndex++ if index <= $scope.cutPageIndex\r\n    $scope.pages.splice $scope.cutPageIndex, 1\r\n\r\n    $scope.cutting = false\r\n    $scope.save()\r\n\r\n  $scope.sortPages =\r\n    stop: (e, ui) ->\r\n      $scope.save()\r\n\r\n  $scope.changeTileSize = (size) ->\r\n    $scope.tileSize = size\r\n    false\r\n\r\n  $scope.loadpages = ->\r\n    pagesSrv.load()\r\n    .success (response) ->\r\n      $scope.pages = response\r\n    .error (status, error) ->\r\n      console.log 'not loaded', status, error\r\n\r\n  $scope.save = ->\r\n    pagesSrv.save($scope.pages)\r\n    .success (response) ->\r\n      console.log 'save success: ', response\r\n    .error (status, error) ->\r\n      console.log 'save error: ', status, error\r\n\r\n  $scope.delete = (index) ->\r\n    pagesSrv.delete(index)\r\n    .success (response) ->\r\n      $scope.pages.splice(index, 1)\r\n      $scope.save()\r\n      console.log 'delete success: ', response\r\n    .error (status, error) ->\r\n      console.log 'delete error: ', response, error\r\n\r\n  $scope.deletePageFiles = (index) ->\r\n    pagesSrv.delete(index)\r\n    .error (status, error) ->\r\n      console.log 'delete error: ', response, error\r\n\r\n  $scope.upload = (form) ->\r\n    pagesSrv.upload(form)\r\n    .always ->\r\n      $scope.hideLoader()\r\n\r\n  $scope.edit = (index) ->\r\n    pagesSrv.edit(index)\r\n\r\n  $scope.pdf = (pages) ->\r\n    pagesSrv.pdf(pages)\r\n    .success (response) ->\r\n      console.log 'PDF generated! ', response\r\n    .error (status, error) ->\r\n      console.log 'Error occured while generating PDF: ', status, error\r\n\r\n  $scope.print = (page) ->\r\n    pagesSrv.pdf(page)\r\n\r\n  $scope.preview = (page) ->\r\n    previewPage = $scope.pages[page].svg.file\r\n    $scope.previewImgURL = \"jpg/w800/\" + $filter('encodeFilename')(previewPage) + \".jpg\"\r\n    $scope.isPreview = true\r\n\r\n  $scope.hidePreview = () ->\r\n    $scope.isPreview = false\r\n\r\n  $scope.showLoader = () ->\r\n    $scope.$apply () ->\r\n      $scope.isLoading = true\r\n\r\n  $scope.hideLoader = () ->\r\n    $scope.isLoading = false\r\n\r\n  $scope.loadpages()\r\n)\r\n\r\n\r\n# .controller('TodoCtrl', [\r\n#   '$scope'\r\n\r\n# ($scope) ->\r\n\r\n#   $scope.todos = [\r\n#     text: \"learn angular\"\r\n#     done: true\r\n#   ,\r\n#     text: \"build an angular app\"\r\n#     done: false\r\n#   ]\r\n\r\n#   $scope.addTodo = ->\r\n#     $scope.todos.push\r\n#       text: $scope.todoText\r\n#       done: false\r\n\r\n#     $scope.todoText = \"\"\r\n\r\n#   $scope.remaining = ->\r\n#     count = 0\r\n#     angular.forEach $scope.todos, (todo) ->\r\n#       count += (if todo.done then 0 else 1)\r\n\r\n#     count\r\n\r\n#   $scope.archive = ->\r\n#     oldTodos = $scope.todos\r\n#     $scope.todos = []\r\n#     angular.forEach oldTodos, (todo) ->\r\n#       $scope.todos.push todo  unless todo.done\r\n\r\n# ])\r\n\r\n# .controller('MyCtrl1', [\r\n#   '$scope'\r\n\r\n# ($scope) ->\r\n#   $scope.onePlusOne = 2\r\n\r\n# ])\r\n\r\n# .controller('MyCtrl2', [\r\n#   '$scope'\r\n\r\n# ($scope) ->\r\n#   $scope\r\n# ])\r\n","'use strict'\r\n\r\n### Directives ###\r\n\r\n# register the module with Angular\r\nangular.module('app.directives', [\r\n  'app.services'\r\n])\r\n\r\n.directive('tooltip', () ->\r\n\trestrict: 'A'\r\n\tlink: (scope, element) ->\r\n\t\t$(element).tooltip()\r\n)\r\n\r\n.directive('loadpages', () ->\r\n\trestrict: 'A'\r\n\ttemplate: 'Load pages'\r\n\tlink: (scope, element) ->\r\n\t\t$(element).bind('click', (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tscope.loadpages()\r\n\t\t\tfalse\r\n\t\t)\r\n)\r\n\r\n.directive('save', () ->\r\n\trestrict: 'A'\r\n\ttemplate: 'Save'\r\n\tlink: (scope, element) ->\r\n\t\t$(element).bind('click', (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tscope.save()\r\n\t\t\tfalse\r\n\t\t)\r\n)\r\n\r\n.directive('pdf', () ->\r\n\trestrict: 'A'\r\n\ttemplate: 'Zbuduj katalog'\r\n\tlink: (scope, element) ->\r\n\t\t$(element).bind('click', (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\telement.text 'Robi się'\r\n\t\t\tscope.pdf(scope.pages)\r\n\t\t\t\t.success (response) ->\r\n\t\t\t\t\telement.text 'Zbuduj katalog'\r\n\t\t\tfalse\r\n\t\t)\r\n)\r\n\r\n.directive('addpage', () ->\r\n\trestrict: 'E'\r\n\ttemplate: '<form enctype=\"multipart/form-data\"><input name=\"page\" type=\"file\" class=\"addpage\"></form>'\r\n\tlink: (scope, element, attrs) ->\r\n\t\tform = element.find('form')\r\n\t\tinput = form.find('input[type=\"file\"]')\r\n\r\n\t\tinput.bind 'change', ->\r\n\t\t\tscope.showLoader()\r\n\t\t\tform.submit()\r\n\r\n\t\tform.bind 'submit', (e) ->\r\n\t\t\te.preventDefault()\r\n\r\n\t\t\tif attrs.index?\t\t# REPLACING SELECTED PAGE WITH NEW VERSION\r\n\t\t\t\tupload(@)\r\n\t\t\t\t.done (res) ->\r\n\t\t\t\t\tpage = res.data\r\n\t\t\t\t\treplace attrs.index, page\r\n\t\t\telse\r\n\t\t\t\tupload(@)\r\n\t\t\t\t.done (res) ->\r\n\t\t\t\t\tscope.pages.push res.data\r\n\t\t\t\t\tscope.save()\r\n\r\n\t\treplace = (index, page) ->\r\n\t\t\tscope.deletePageFiles(index)\r\n\t\t\t.success (res) ->\r\n\t\t\t\tscope.pages[index] = page\r\n\t\t\t\tscope.save()\r\n\r\n\t\tupload = (form) ->\r\n\t\t\tdef = new $.Deferred()\r\n\r\n\t\t\tscope.upload(form)\r\n\t\t\t.done (res) ->\r\n\t\t\t\tres = JSON.parse(res)\r\n\t\t\t\tif res.status is 'ok'\r\n\t\t\t\t\tdef.resolve res\r\n\t\t\t\telse\r\n\t\t\t\t\tonUploadPageFail res\r\n\t\t\t\t\tdef.reject res\r\n\r\n\t\t\t.fail (failResp) ->\r\n\t\t\t\tconsole.log('directive upload fail');\r\n\t\t\t\tonUploadPageFail failResp\r\n\t\t\t\tdef.reject failResp\r\n\r\n\t\t\tdef.promise()\r\n\r\n\t\tonUploadPageFail = (res) ->\r\n\t\t\tconsole.log 'submit error', res\r\n\r\n)\r\n\r\n.directive 'delete', () ->\r\n\t(scope, element, attrs) ->\r\n\t\t$(element).click (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tindex = parseInt attrs.index, 10\r\n\t\t\tif confirm 'Czy na pewno chcesz usunąć stronę? ' + '[' +  (index + 1)  + ']'\r\n\t\t\t\tscope.delete index\r\n\t\t\tfalse\r\n\r\n.directive 'edit', () ->\r\n\t(scope, element, attrs) ->\r\n\t\t$(element).click (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tindex = attrs.index\r\n\t\t\tscope.edit index\r\n\t\t\tfalse\r\n\r\n# .directive 'cut', () ->\r\n# \t(scope, element, attrs) ->\r\n# \t\t$(element).click (e) ->\r\n# \t\t\te.preventDefault()\r\n# \t\t\tindex = attrs.index\r\n\r\n# \t\t\t# SET ISCUT SELECTION FOR THIS PAGE\r\n# \t\t\t# scope.isCut = true\r\n\r\n# \t\t\t# if (scope.cutting && scope.isCut) || not scope.cutting\r\n# \t\t\t# \tscope.isCut = !scope.isCut\r\n# \t\t\t# \tscope.setCutting scope.isCut, index\r\n# \t\t\t# \tscope.$apply()\r\n\r\n# \t\t\tscope.$apply(attrs.cut)\r\n\r\n# \t\t\tfalse\r\n\r\n.directive 'paste', () ->\r\n\t(scope, element, attrs) ->\r\n\r\n\t\t$(element).click (e) ->\r\n\t\t\te.preventDefault()\r\n\r\n\t\t\t# index = attrs.index\r\n\t\t\t# console.log 'paste page nr ' + scope.cutPageIndex + ' before page nr ' + (parseInt(index,10)+1)\r\n\r\n\t\t\tscope.$apply(attrs.paste)\r\n\r\n\t\t\tfalse\r\n\r\n.directive 'print', () ->\r\n\t(scope, element) ->\r\n\t\t$(element).click (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tprintframe = $('#printFrame')\r\n\r\n\t\t\tprintframe.load ->\r\n\t\t\t\tprintframe[0].contentWindow.print()\r\n\r\n\t\t\tprintframe[0].src = 'svg/' + scope.page.svg.file\r\n\r\n\t\t\tconsole.log scope.page\r\n\r\n\t\t\tfalse\r\n\r\n.directive 'disablepage', () ->\r\n\t(scope, element) ->\r\n\t\t$(element).click (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tif scope.page.status is 'disable'\r\n\t\t\t\tscope.page.status = 'enable'\r\n\t\t\telse\r\n\t\t\t \tscope.page.status = 'disable'\r\n\r\n\t\t\tscope.save()\r\n\r\n\t\t\tfalse\r\n\r\n.directive 'lazySrc', ($window, $document) ->\r\n\r\n\tclass lazyLoader\r\n\t\t@test: 'test1'\r\n\r\n\tclass lazyImage\r\n\t\tconstructor: () ->\r\n\t\t\tconsole.log 'lazy image created'\r\n\r\n\t{\r\n\trestrict: 'A'\r\n\tlink: ($scope, $element) ->\r\n\t\tconsole.log lazyLoader.test\r\n\t}\r\n\r\n\r\n","'use strict'\r\n\r\n### Filters ###\r\n\r\nangular.module('app.filters', [])\r\n\r\n.filter('interpolate', [\r\n  'version',\r\n\r\n(version) ->\r\n  (text) ->\r\n    String(text).replace(/\\%VERSION\\%/mg, version)\r\n])\r\n\r\n.filter('encodeFilename', ()->\r\n  (filename) ->\r\n    filename.split(' ').join('_')\r\n)\r\n","'use strict'\r\n\r\n### Sevices ###\r\n\r\nangular.module('app.services', [])\r\n\r\n.factory 'version', ->\r\n\t\"0.2\"\r\n\r\n# .factory 'pages', ($rootScope, $http, $q) ->\r\n#   save: ->\r\n#     $http.post('http://localhost:3000/api/save/dd')\r\n\r\n#   load: ->\r\n# \t  console.log 'factory loading'\r\n# \t  $http.get('http://localhost:3000/api/pages')\r\n\r\n.service 'pagesSrv', ($rootScope, $http, $q) ->\r\n  @save = (json) ->\r\n    $http.post('http://localhost:3000/api/save', {jsondata: JSON.stringify(json)})\r\n\r\n  @load = ->\r\n    $http.get('http://localhost:3000/api/pages')\r\n\r\n  @pdf = (json) ->\r\n    console.log 'generationg PDF'\r\n    $http.post('http://localhost:3000/api/pdf', {jsondata: JSON.stringify(json)})\r\n\r\n  @delete = (index) ->\r\n    console.log 'deleting page number ' + (parseInt(index,10) + 1)\r\n    $http.get('http://localhost:3000/api/delete/' + index)\r\n\r\n  @edit = (index) ->\r\n    console.log 'edit page number ' + (index + 1)\r\n    $http.get('http://localhost:3000/api/edit/' + index)\r\n\r\n  # @add = (file) ->\r\n  #   console.log 'service - adding file'\r\n  #   $http.post('http://localhost:3000/api/add')\r\n\r\n  @upload = (form) ->\r\n    def = new $.Deferred()\r\n    $(form).ajaxSubmit\r\n      url: 'http://localhost:3000/api/add'\r\n      type: 'POST'\r\n      timeout: 600000 # have you ever seen a 10min timeout? I bet not.\r\n      success: (response) ->\r\n        def.resolve response\r\n      error: (response) ->\r\n        console.log('srv upload error');\r\n        def.reject response\r\n\r\n    def.promise()\r\n"]}